# 操作系统 第2章习题 杨茂琛 191180164

> 思考题：19, 38, 45
>
> 应用题：2, 4, 7, 8, 12, 15, 16, 17

## 19 进程有哪些主要属性？

1. 动态性
2. 共享性
3. 独立性
4. 制约性
5. 并发性



## 38 从调度、并发性、拥有资源和系统开销等4个方面对传统进程和多线程进程进行比较

| 比较项   | 传统进程                                                     | 多线程进程                                                   |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 调度     | 需要进行进程上下文切换：保存现场，多次修改PCB，设置地址空间，恢复现场 | 同一进程中的多线程切换只需改变堆栈和寄存器，地址空间不变     |
| 并发性   | 使得多个程序并发执行                                         | 减少程序并发执行时所付出的时空开销，使得并发粒度更细、并发性更好 |
| 拥有资源 | 各个进程拥有独立的PCB、独立的存储空间                        | 同一进程的所有线程共享存储资源                               |
| 系统开销 | 较大，需要频繁切换进程及其分配的独立资源                     | 线程创建和撤销工作比进程少很多，并且无须再分配存储空间和各种资源 |



## 45 分析Linux的`fork()` `vfork()` `clone()`系统调用

| Feature      | `fork()`                                                     | `vfork()`                                                    |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 资源         | 子进程完全复制父进程资源                                     | 父子进程共享地址空间                                         |
| 独立性       | 子进程的执行独立于父进程                                     | 父进程被阻塞直到子进程挂起`execve()`或`exit()`               |
| 数据共享方法 | 进程间通信机制                                               | 共享地址空间                                                 |
| 返回值       | 父进程中会返回子进程的PID值，子进程中会返回`0`；调用失败返回`-1` | 父进程中会返回子进程的PID值，子进程中会返回`0`；调用失败返回`-1` |

`clone()`是轻量级的系统调用，通过参数来定制新进程：有选择地继承父进程的内存，创造父进程的兄弟进程



## 2

> 对I/O繁重型作业有利

I/O繁重意味着相对来说较少使用CPU，根据调度算法其理应优先运行

> 并不是永远不受理处理器繁重型作业

在处理器繁重型作业为其他较少使用CPU的作业进行一定让步后，其近期也较少使用处理器，根据调度算法其也能够得到运行



## 4

在时钟中断处理程序中进行。时钟中断随机地在某个进程执行时出现，随机地插入到该进程并重写其动态优先数



## 7

### FCFS

FCFS是非剥夺式

| 执行顺序（上至下） | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ------------------ | -------- | -------- | -------- | ------------ |
| 1                  | 0        | 10       | 10       | 1            |
| 2                  | 10       | 11       | 11       | 11           |
| 3                  | 11       | 13       | 13       | 6.5          |
| 4                  | 13       | 14       | 14       | 14           |
| 5                  | 14       | 19       | 19       | 3.8          |

平均周转时间：$(10+11+13+14+19)/5=13.4$

平均带权周转时间：$(1+11+6.5+14+3.8)/5=7.26$

### RR

RR是剥夺式

此处令时间片长度为$2\text{ms}$，执行次序为：1、2（3ms时已完成）、3（5ms时已完成）、4（6ms时已完成）、5、1、5、1、5（15ms时已完成）、1（独自运行至19ms完成）

| 任务 | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ---- | -------- | -------- | -------- | ------------ |
| 1    | 0        | 19       | 19       | 1.9          |
| 2    | 2        | 3        | 3        | 3            |
| 3    | 3        | 5        | 5        | 2.5          |
| 4    | 5        | 6        | 6        | 6            |
| 5    | 6        | 15       | 15       | 3            |

平均周转时间：$(19+3+5+6+15)/5=9.6$

平均带权周转时间：$(1.9+3+2.5+6+3)/5=3.28$

### SJF

SJF是非剥夺式

对于同样执行时间的任务，选择最先到达的执行

执行顺序为：2、4、3、5、1

| 执行顺序（上至下） | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ------------------ | -------- | -------- | -------- | ------------ |
| 2                  | 0        | 1        | 1        | 1            |
| 4                  | 1        | 2        | 2        | 2            |
| 3                  | 2        | 4        | 4        | 2            |
| 5                  | 4        | 9        | 9        | 1.8          |
| 1                  | 9        | 19       | 19       | 1.9          |

平均周转时间：$(1+2+4+9+19)/5=7$

平均带权周转时间：$(1+2+2+1.8+1.9)/5=1.73\overline{9}$

### 非抢占优先权调度

执行顺序为：2、5、1、3、4

| 执行顺序（上至下） | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ------------------ | -------- | -------- | -------- | ------------ |
| 2                  | 0        | 1        | 1        | 1            |
| 5                  | 1        | 6        | 6        | 1.2          |
| 1                  | 6        | 16       | 16       | 1.6          |
| 3                  | 16       | 18       | 18       | 9            |
| 4                  | 18       | 19       | 19       | 19           |

平均周转时间：$(1+6+16+18+19)/5=12$

平均带权周转时间：$(1+1.2+1.6+9+19)/5=6.36$



## 8

执行顺序：1（30/60）、2（10/50）、3（30/30）、4（10/10）、2（50/50）、1（60/60）

| 作业名  | 进入后备队列的时刻 | 执行时间/min | 开始执行时刻 | 结束执行时刻 | 周转时间/min | 带权周转时间/min |
| ------- | ------------------ | ------------ | ------------ | ------------ | ------------ | ---------------- |
| $Job_1$ | 8：00              | 60           | 8：00        | 10：30       | 150          | 2.5              |
| $Job_2$ | 8：30              | 50           | 8：30        | 10：00       | 90           | 1.8              |
| $Job_3$ | 8：40              | 30           | 8：40        | 9：10        | 30           | 1                |
| $Job_4$ | 8：50              | 10           | 9：10        | 9：20        | 10           | 1                |

平均周转时间 $T=(150+90+30+10)/4=70$

平均带权周转时间 $W=(2.5+1.8+1+1)/4=1.575$



## 12

### FCFS

运行顺序：A B C D E

| 任务 | 开始时间 | 结束时间 | 周转时间 |
| ---- | -------- | -------- | -------- |
| A    | 0        | 10       | 10       |
| B    | 10       | 16       | 16       |
| C    | 16       | 18       | 18       |
| D    | 18       | 22       | 22       |
| E    | 22       | 30       | 30       |

平均周转时间：$(10+16+18+22+30)/5=19.2$

### 优先级调度算法

假设非剥夺式调度

执行顺序为：B E A C D

| 任务 | 开始时间 | 结束时间 | 周转时间 |
| ---- | -------- | -------- | -------- |
| B    | 0        | 6        | 6        |
| E    | 6        | 14       | 14       |
| A    | 14       | 24       | 24       |
| C    | 24       | 26       | 26       |
| D    | 26       | 30       | 30       |

平均周转时间：$(6+14+24+26+30)/5=20$

### RR

RR是非剥夺式的

假设时间片为 $2 \text{min}$

执行顺序为：A(2/10) B(2/6) C(2/2) D(2/4) E(2/8) A(4/10) B(4/6) D(4/4) E(4/8) A(6/10) B(6/6) E(6/8) A(8/10) E(8/8) A(10/10)

| 任务 | 开始时间 | 结束时间 | 周转时间 |
| ---- | -------- | -------- | -------- |
| A    | 0        | 30       | 30       |
| B    | 2        | 22       | 22       |
| C    | 4        | 6        | 6        |
| D    | 6        | 16       | 16       |
| E    | 8        | 28       | 28       |

平均周转时间：$(30+22+6+16+28)/5=20.4$



## 15

### FCFS

执行顺序：1、2、3

| 作业 | 提交时刻 | 运行时刻（时间） | 开始时刻 | 完成时刻 | 周转时间/min | 带权周转时间/min |
| ---- | -------- | ---------------- | -------- | -------- | ------------ | ---------------- |
| 1    | 10:00    | 2:00(120)        | 10:00    | 12:00    | 120          | 1                |
| 2    | 10:10    | 1:00(60)         | 12:00    | 13:00    | 180          | 3                |
| 3    | 10:25    | 0:25(25)         | 13:00    | 13:25    | 205          | 8.2              |

平均周转时间 $T=(120+180+205)/3=168.\overline{3}$

平均带权周转时间 $W=(1+3+8.2)/3=4.0\overline{6}$

### HRRF

执行顺序：1、3（$1+110/60 < 1+95/25$）、2

| 作业 | 提交时刻 | 运行时刻（时间） | 开始时刻 | 完成时刻 | 周转时间/min | 带权周转时间/min |
| ---- | -------- | ---------------- | -------- | -------- | ------------ | ---------------- |
| 1    | 10:00    | 2:00(120)        | 10:00    | 12:00    | 120          | 1                |
| 2    | 10:10    | 1:00(60)         | 12:25    | 13:25    | 205          | 3.416            |
| 3    | 10:25    | 0:25(25)         | 12:00    | 12:25    | 145          | 5.8              |

平均周转时间 $T=(120+205+145)/3=156.\overline{6}$

平均带权周转时间 $W=(1+205/60+5.8)/3=3.40\overline{5}$



对比FCFC和HRRF，HRRF的平均周转时间和平均带权周转时间都更优秀，HRRF性能更好



## 16

### FCFS

执行顺序为：1、2、3、4

| 任务 | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ---- | -------- | -------- | -------- | ------------ |
| 1    | 8:00     | 10:00    | 120      | 1            |
| 2    | 10:00    | 10:50    | 170      | 3.4          |
| 3    | 10:50    | 11:00    | 180      | 18           |
| 4    | 11:00    | 11:20    | 200      | 10           |

平均周转时间：$(120+170+180+200)/4=167.5$

平均带权周转时间：$(1+3.4+18+10)/4=8.1$

### SJF

执行顺序为：1、3、4、2

| 任务 | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ---- | -------- | -------- | -------- | ------------ |
| 1    | 8:00     | 10:00    | 120      | 1            |
| 3    | 10:00    | 10:10    | 130      | 13           |
| 4    | 10:10    | 10:30    | 150      | 7.5          |
| 2    | 10:30    | 11:20    | 200      | 4            |

平均周转时间：$(120+130+150+200)/4=150$

平均带权周转时间：$(1+13+7.5+4)/4=6.375$

### HRRF

执行顺序为：1、3（$1+70/50<1+60/10>1+10/20$）、2（$1+80/50>1+20/20$）、4

| 任务 | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ---- | -------- | -------- | -------- | ------------ |
| 1    | 8:00     | 10:00    | 120      | 1            |
| 3    | 10:00    | 10:10    | 130      | 13           |
| 4    | 10:10    | 10:30    | 150      | 7.5          |
| 2    | 10:30    | 11:20    | 200      | 4            |

平均周转时间：$(120+130+150+200)/4=150$

平均带权周转时间：$(1+13+7.5+4)/4=6.375$



## 17

执行顺序：1(5/30) 2(5/20) 3(5/5) 2(10/20) 4(10/10) 2(20/20) 1(30/30)

| 任务 | 开始时间 | 结束时间 | 周转时间 | 带权周转时间 |
| ---- | -------- | -------- | -------- | ------------ |
| 1    | 10:00    | 11:10    | 70       | 2.3          |
| 2    | 10:05    | 10:45    | 40       | 2            |
| 3    | 10:10    | 10:15    | 5        | 1            |
| 4    | 10:25    | 10:35    | 10       | 10           |

平均周转时间：$(70+40+5+10)/4=31.25$

平均带权周转时间：$(70/30+2+1+10)/4=3.8\overline{3}$
