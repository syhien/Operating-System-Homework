# 191180164 杨茂琛 作业4

## 2

### 1

#### FIFO

FIFO淘汰在内存中停驻时间最长的页面，访问在内存中的页面不会延迟页面的淘汰

| 本次请求的页 | 本次请求之后的页表 | 本次是否发生缺页 |
| ------------ | ------------------ | ---------------- |
| /            |                    |                  |
| 1            | 1                  | 1                |
| 4            | 14                 | 1                |
| 3            | 143                | 1                |
| 1            | 143                |                  |
| 2            | 432                | 1                |
| 5            | 325                | 1                |
| 1            | 251                | 1                |
| 4            | 514                | 1                |
| 2            | 142                | 1                |
| 1            | 142                |                  |
| 4            | 142                |                  |
| 5            | 425                | 1                |

缺页异常次数：9

缺页中断率：$9\div12=75\%$

#### LRU

| 本次请求的页 | 本次请求之后的页表 | 本次是否发生缺页 |
| ------------ | ------------------ | ---------------- |
| /            |                    |                  |
| 1            | 1                  | 1                |
| 4            | 14                 | 1                |
| 3            | 143                | 1                |
| 1            | 431                |                  |
| 2            | 312                | 1                |
| 5            | 125                | 1                |
| 1            | 251                |                  |
| 4            | 514                | 1                |
| 2            | 142                | 1                |
| 1            | 421                |                  |
| 4            | 214                |                  |
| 5            | 145                | 1                |

缺页异常次数：8

缺页中断率：$8\div12=66.6\%$

### 2

#### FIFO

| 本次请求的页 | 本次请求之后的页表 | 本次是否发生缺页 |
| ------------ | ------------------ | ---------------- |
| /            |                    |                  |
| 3            | 3                  | 1                |
| 2            | 32                 | 1                |
| 1            | 321                | 1                |
| 4            | 214                | 1                |
| 4            | 214                |                  |
| 5            | 145                | 1                |
| 5            | 145                |                  |
| 3            | 453                | 1                |
| 4            | 453                |                  |
| 3            | 453                |                  |
| 2            | 532                | 1                |
| 1            | 321                | 1                |
| 5            | 215                | 1                |

缺页异常次数：9

缺页中断率：$9\div13=69.2\%$

#### LRU

| 本次请求的页 | 本次请求后的页表 | 本次是否发生缺页 |
| ------------ | ---------------- | ---------------- |
| /            |                  |                  |
| 3            | 3                | 1                |
| 2            | 32               | 1                |
| 1            | 321              | 1                |
| 4            | 214              | 1                |
| 4            | 214              |                  |
| 5            | 145              | 1                |
| 5            | 145              |                  |
| 3            | 453              | 1                |
| 4            | 534              |                  |
| 3            | 543              |                  |
| 2            | 432              | 1                |
| 1            | 321              | 1                |
| 5            | 215              | 1                |

缺页异常次数：9

缺页中断率：$9\div13=69.2\%$

## 4

### 1

#### 首次适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 8 18 7 9 12 15    | 3(20)                |
| 10                   | / 4 8 18 7 9 12 15     | 1(10)                |
| 9                    | / 4 8 9 7 9 12 15      | 4(18)                |

#### 最佳适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 20 18 7 9 / 15    | 7(12)                |
| 10                   | / 4 20 18 7 9 / 15     | 1(10)                |
| 9                    | / 4 20 18 7 / / 15     | 6(9)                 |

#### 最差适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 8 18 7 9 12 15    | 3(20)                |
| 10                   | 10 4 8 8 7 9 12 15     | 4(18)                |
| 9                    | 10 4 8 8 7 9 12 6      | 8(15)                |

#### 下次适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | ^ 10 4 20 18 7 9 12 15 | 序号(请求前大小)     |
| 12                   | 10 4 ^ 8 18 7 9 12 15  | 3(20)                |
| 10                   | 10 4 8 ^ 8 7 9 12 15   | 4(18)                |
| 9                    | 10 4 8 8 7 / ^ 12 15   | 6(9)                 |

### 2

#### 首次适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 8 18 7 9 12 15    | 3(20)                |
| 10                   | / 4 8 18 7 9 12 15     | 1(10)                |
| 15                   | / 4 8 3 7 9 12 15      | 4(18)                |
| 18                   | / 4 8 3 7 9 12 15      | /                    |

#### 最佳适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 20 18 7 9 / 15    | 7(12)                |
| 10                   | / 4 20 18 7 9 / 15     | 1(10)                |
| 15                   | / 4 20 18 7 9 / /      | 8(15)                |
| 18                   | / 4 20 / 7 9 / /       | 4(18)                |

#### 最差适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | 10 4 20 18 7 9 12 15   | 序号(请求前大小)     |
| 12                   | 10 4 8 18 7 9 12 15    | 3(20)                |
| 10                   | 10 4 8 8 7 9 12 15     | 4(18)                |
| 15                   | 10 4 8 8 7 9 12 /      | 8(15)                |
| 18                   | 10 4 8 8 7 9 12 /      | /                    |

#### 下次适应算法

| 本次请求存储区的大小 | 本次请求后的空闲存储区 | 本次请求使用的存储区 |
| -------------------- | ---------------------- | -------------------- |
| /                    | ^ 10 4 20 18 7 9 12 15 | 序号(请求前大小)     |
| 12                   | 10 4 ^ 8 18 7 9 12 15  | 3(20)                |
| 10                   | 10 4 8 ^ 8 7 9 12 15   | 4(18)                |
| 15                   | 10 4 8 8 7 9 12 / ^    | 8(15)                |
| 18                   | 10 4 8 8 7 9 12 / ^    | /                    |

## 9

$$
\text{访问地址且已装入cache的概率为}P_1=0.9\\
\text{访问地址，地址在内存但不在cache的概率为}P_2=(1-P_1)*0.6=0.06\\
\text{访问地址，地址不在cache、不在内存而在外存的概率为}P_3=(1-P_1)*(1-0.6)=0.04\\
\text{平均访问时间为}T=P_1*20+P_2*(60+20)+P_3*(12*1000+60+20)=506
$$

注意从内存、外存读取的用时为：装入用时+访问（cache）用时

## 17

页长为8KB，页内偏移量为$\log_28+10=13$位

那么页表有$2^{48-13=35}$个页表项，反置页表有$2^{32-13=19}$个页表项

## 30

### 1

默认页号从0开始计数，则页面访问序列为：

1 1 2 2 0 4 2 3 3 5 5 4

### 2

在分得3页框的情况下

#### FIFO

| 本次请求页 | 本次请求后的页表 | 本次请求是否发生缺页 |
| ---------- | ---------------- | -------------------- |
| /          |                  |                      |
| 1          | 1                | 1                    |
| 1          | 1                |                      |
| 2          | 1 2              | 1                    |
| 2          | 1 2              |                      |
| 0          | 1 2 0            | 1                    |
| 4          | 2 0 4            | 1                    |
| 2          | 2 0 4            |                      |
| 3          | 0 4 3            | 1                    |
| 3          | 0 4 3            |                      |
| 5          | 4 3 5            | 1                    |
| 5          | 4 3 5            |                      |
| 4          | 4 3 5            |                      |

缺页中断率为：$6\div12=50\%$

#### LRU

| 本次请求页 | 本次请求后的页表 | 本次请求是否发生缺页 |
| ---------- | ---------------- | -------------------- |
| /          |                  |                      |
| 1          | 1                | 1                    |
| 1          | 1                |                      |
| 2          | 1 2              | 1                    |
| 2          | 1 2              |                      |
| 0          | 1 2 0            | 1                    |
| 4          | 2 0 4            | 1                    |
| 2          | 0 4 2            |                      |
| 3          | 4 2 3            | 1                    |
| 3          | 4 2 3            |                      |
| 5          | 2 3 5            | 1                    |
| 5          | 2 3 5            |                      |
| 4          | 3 5 4            | 1                    |

缺页中断率为：$7\div12=58.3\%$

## 41

先计算一下缺页中断率：

| 本次请求页 | 本次请求后的页表 | 本次请求是否发生缺页 |
| ---------- | ---------------- | -------------------- |
| /          |                  |                      |
| 7          | 7                | 1                    |
| 0          | 7 0              | 1                    |
| 1          | 7 0 1            | 1                    |
| 2          | 0 1 2            | 1                    |
| 0          | 1 2 0            |                      |
| 3          | 2 0 3            | 1                    |
| 0          | 2 3 0            |                      |
| 4          | 3 0 4            | 1                    |
| 2          | 0 4 2            | 1                    |
| 3          | 4 2 3            | 1                    |
| 0          | 2 3 0            | 1                    |
| 3          | 2 0 3            |                      |
| 2          | 0 3 2            |                      |
| 1          | 3 2 1            | 1                    |
| 2          | 3 1 2            |                      |
| 0          | 1 2 0            | 1                    |
| 1          | 2 0 1            |                      |
| 7          | 0 1 7            | 1                    |
| 0          | 1 7 0            |                      |
| 1          | 7 0 1            |                      |

缺页中断率为：$12/20=60\%$

计算平均**不发生缺页情况下**访存用时：$0.2*(20+100)+(1-0.2)*(20+100+100)=200$（快表命中时，访问快表+访问内存；快表未命中时，访问快表+访问页表（内存）+访问内存）

**发生缺页情况下**访存用时：$25*10^3+100+100=25200$（缺页处理+访问页表（内存）+访问内存）

综上，平均有效访问时间为：$(1-0.6)*200+0.6*25200=15200$
